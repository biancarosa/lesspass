<style>
  #menu .white-link, #menu .text-white {
    color: inherit;
  }

  #menu .white-link:hover, #menu .white-link:focus, #menu .white-link:active {
    text-decoration: none;
    color: inherit;
  }

  .card-inverse {
    background-color: #333;
    border-color: #333;
  }
</style>
<template>
  <div id="menu">
    <div class="card-header" v-bind:class="{ 'text-white bg-dark': isGuest}">
      <div class="row">
        <div class="col-4">
          <span id="title" v-on:click="fullReload()" class="white-link pointer">LessPass</span>
        </div>
        <div class="col-8 text-right">
          <span v-if="saved && isAuthenticated">
            <small><i class="fa fa-lg fa-check pl-3"></i> saved</small>
          </span>
          <span class="white-link"
                v-on:click="saveOrUpdatePassword()"
                v-if="!saved && $store.state.password.site !== '' && $store.state.route.path === '/'" :title="$t('Save')">
            <i class="fa fa-lg fa-save pointer"></i>
          </span>
          <router-link class="white-link pl-3" v-if="$store.state.passwords.length > 0" :to="{ name: 'exportProfiles'}" :title="$t('Export Password Profiles')">
            <i class="fa fa-lg fa-download"></i>
          </router-link>
          <router-link class="white-link pl-3" :to="{ name: 'importProfiles'}" :title="$t('Import Password Profiles')">
            <i class="fa fa-lg fa-upload"></i>
          </router-link>
          <router-link class="white-link pl-3" :to="{ name: 'passwords'}" :title="$t('Saved passwords')">
            <i class="fa fa-lg fa-key"></i>
          </router-link>
          <router-link class="white-link pl-3" :to="{ name: 'settings'}" :title="$t('Settings')">
            <i class="fa fa-lg fa-cog"></i>
          </router-link>
          <router-link class="white-link pl-3" :to="{ name: 'myaccount'}" v-if="isAuthenticated" :title="$t('My Account')">
            <i class="fa fa-lg fa-user pointer"></i>
          </router-link>
          <router-link class="white-link pl-3" :to="{ name: 'login'}" v-if="isGuest" :title="$t('Sign In')">
            <i class="fa fa-lg fa-sign-in pointer"></i>
          </router-link>
        </div>
      </div>
    </div>
  </div>
</template>
<script type="text/ecmascript-6">
  import { mapGetters, mapState } from 'vuex';

  export default {
    data() {
      return {
        saved: false
      }
    },
    methods: {
      fullReload() {
        this.$store.dispatch('resetPassword');
        this.$router.push({name: 'home'}).catch(e => {});
      },
      saveOrUpdatePassword() {
        this.$store.dispatch('saveOrUpdatePassword');
        this.saved = true;
        setTimeout(() => {
          this.saved = false;
        }, 3000);
      },
      downloadPasswordProfiles() {
        this.$store.dispatch('downloadPasswords');
      }
    },
    computed: {
      ...mapGetters([
        'isAuthenticated',
        'isGuest'
      ]),
      ...mapState(["passwords"]),
    }
  }
</script>
